---
author: Kolyn090
banner: /static/img/svz/player-hp-banner.png
categories: Tutorial
custom_class: custom-page-content
date: 2025-02-10 14:00:00 -0500
layout: post
permalink: /svz-player-hp/
theme: sushi
title: Getting coins amount with Custom Template
---


**This article, completely original, is copyrighted by its author, me. Please do not reproduce it.**


**本文为原创作品，作者 Kolyn090 拥有其著作权，受法律保护。严禁复制、转载、仿冒或以任何形式使用。**


Category: Tutorial


Platform: Windows


Prerequisite: Basic Python, read [this article](/svz-pachinko/)


## Introduction
This is the very first thing we are going to do for a [big plan](/svz-battle/)! Today we will be reading the player's health point from a health bar using Computer Graphics techniques. You should be able to apply what you will be learning to most of the basic health bars. 

Before we get into the tutorial, we need to understand what exactly is a health bar to us. 
1. It represents the health point of something (e.g. Your character) and it usually consists of a filling area and a background. 
2. Larger the filling area means more health. The filling area and the background usually have different colors. 
3. Sometime a numerical representation is shown next to the health bar, and it would be much easier to read that instead (but unfortunately we don't have that in this case).
4. The color of the filling area and background could be complex! Luckily in this case it's simple. If you are working with some very interest cases you will have to do some additional tricks / use [Cheat Engine](https://cheatengine.org/) to read the value.


## The general idea
As usual, let's plan out the approach step by step. Assuming you have the screenshot from the game.


1 . **Crop out the health bar.** 


2 . **Select pivot rows.**


3 . **Color quantization.**


4 . **Calculate background area.**


5 . **Remaining HP = 1 - (background area / total area).**

---

<u>The first step is perhaps the most important one among them!</u> You might not even get a result if you don't do this correctly. Make sure you include only the necessary part. Otherwise you will run into problems in color quantization (color reduction). If the hp bar is static, you can predefine a bound for hp bar. If it's moving, the difficulty will exponentially increase! Fortunately in our case it's static. 

---

The second step is optimization. I hope you can agree with me that there is no need to process the entire hp bar. Here is what I mean:


![hp_bar_example](/static/img/svz/hp_bar_example.png)


You can see that it's good enough to just take the central rows, like shown in the image. We will get a very close result as well by processing this smaller region. In fact, we can even combine step 1 and step 2 together. 

---

The third step is color quantization. It's a fancy word saying reducing the number of colors in the image. Visually, it's like:


![hp_bar_example2](/static/img/svz/hp_bar_example2.png)


![hp_bar_example3](/static/img/svz/hp_bar_example3.png)


Here the quantization algorithm has reduced 97 colors (top) to 3 colors (bottom). We do this to reduce noises in the image. In our case, we want to reduce to 2 ~ 3 colors so that we the filling area and the background can be easily distinguished.

---

Now comes the fourth step. You might be wondering why we choose to calculate the background color area instead of the filling area. Well, by observing our hp bar we find out that the color of our filling area is changing (green - yellow - red) while the background color is always gray. That gives a good reason why we choose that over the other. In the fifth step, we will use this area to divide by the area of the hp bar image to get the ratio of background, which is the ratio of **lost HP**. To get the remaining HP, it's just 1 - lost HP. 


# Step 1
